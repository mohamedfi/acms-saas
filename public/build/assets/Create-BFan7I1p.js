import{r as u,u as B,j as e,H as F,L as N}from"./app-DPxrnJH9.js";import{A as O}from"./AuthenticatedLayout-dpSZcWTj.js";import{I as i}from"./InputLabel-CYi2xdYW.js";import{T as w}from"./TextInput-B1ojRlN6.js";import{I as c}from"./InputError-DdxEaauq.js";import{P as W}from"./PrimaryButton-CXPnii3m.js";import"./ApplicationLogo-CRVY01fr.js";import"./transition-DYabZw25.js";function ae({templates:y,participants:x,employees:v,courses:q}){const[n,C]=u.useState("email"),[z,G]=u.useState("announcement"),[S,j]=u.useState(""),[p,_]=u.useState(!1),[t,l]=u.useState([]),[m,h]=u.useState(""),{data:g,setData:r,post:R,processing:f,errors:d,reset:E}=B({recipients:[],template_id:"",subject:"",content:"",channel:"email",category:"announcement",priority:"normal",scheduled_at:""}),T=[{value:"email",label:"ğŸ“§ Email",icon:"ğŸ“§"},{value:"sms",label:"ğŸ’¬ SMS",icon:"ğŸ’¬"},{value:"whatsapp",label:"ğŸ“± WhatsApp",icon:"ğŸ“±"}],A=[{value:"course",label:"ğŸ“š Course Related",icon:"ğŸ“š"},{value:"task",label:"ğŸ“‹ Task Related",icon:"ğŸ“‹"},{value:"announcement",label:"ğŸ“¢ Announcement",icon:"ğŸ“¢"},{value:"reminder",label:"â° Reminder",icon:"â°"},{value:"welcome",label:"ğŸ‘‹ Welcome",icon:"ğŸ‘‹"},{value:"confirmation",label:"âœ… Confirmation",icon:"âœ…"}],M=[{value:"low",label:"ğŸ”½ Low",color:"text-gray-600"},{value:"normal",label:"â– Normal",color:"text-blue-600"},{value:"high",label:"ğŸ”º High",color:"text-orange-600"},{value:"urgent",label:"ğŸš¨ Urgent",color:"text-red-600"}],P=a=>{C(a),r("channel",a),l(a==="email"?x.map(s=>({type:"email",value:s.email,name:s.full_name,channel:"email"})):x.map(s=>({type:"phone",value:s.phone,name:s.full_name,channel:a}))),r("recipients",t)},$=a=>{if(j(a),r("template_id",a),a){const s=y.find(o=>o.id==a);s&&(r("subject",s.subject||""),r("content",s.content||""),r("category",s.category||"announcement"))}},D=a=>{a.preventDefault(),r("recipients",t),R(route("messages.store"),{onSuccess:()=>{E(),l([]),j("")}})},L=()=>{const a={type:n==="email"?"email":"phone",value:"",name:"",channel:n};l([...t,a])},H=a=>{const s=t.filter((o,b)=>b!==a);l(s)},k=(a,s,o)=>{const b=[...t];b[a][s]=o,l(b)},I=()=>{l(n==="email"?x.map(a=>({type:"email",value:a.email,name:a.full_name,channel:"email"})):x.map(a=>({type:"phone",value:a.phone,name:a.full_name,channel:n}))),h("participants"),r("recipients",t)},U=()=>{l(n==="email"?v.map(a=>({type:"email",value:a.email,name:`${a.first_name} ${a.last_name}`,channel:"email"})):v.map(a=>({type:"phone",value:a.phone,name:`${a.first_name} ${a.last_name}`,channel:n}))),h("employees"),r("recipients",t)};return e.jsxs(O,{header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"ğŸ“¨ Compose Message"}),e.jsx(N,{href:route("messages.index"),className:"inline-flex items-center px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white text-sm font-medium rounded-lg transition-colors duration-200",children:"â¬…ï¸ Back to Messages"})]}),children:[e.jsx(F,{title:"Compose Message"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-6xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:D,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(i,{value:"Communication Channel *"}),e.jsx("div",{className:"mt-2 grid grid-cols-3 gap-3",children:T.map(a=>e.jsxs("button",{type:"button",onClick:()=>P(a.value),className:`p-4 border-2 rounded-lg text-center transition-all ${n===a.value?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 text-blue-900 dark:text-blue-100":"border-gray-300 dark:border-gray-600 hover:border-gray-400 text-gray-700 dark:text-gray-300"}`,children:[e.jsx("div",{className:"text-2xl mb-2",children:a.icon}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.label})]},a.value))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(i,{value:"Category *"}),e.jsx("select",{value:g.category,onChange:a=>r("category",a.target.value),className:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",children:A.map(a=>e.jsxs("option",{value:a.value,children:[a.icon," ",a.label]},a.value))}),e.jsx(c,{message:d.category,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{value:"Priority *"}),e.jsx("select",{value:g.priority,onChange:a=>r("priority",a.target.value),className:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",children:M.map(a=>e.jsx("option",{value:a.value,children:a.label},a.value))}),e.jsx(c,{message:d.priority,className:"mt-2"})]})]}),e.jsxs("div",{children:[e.jsx(i,{value:"Message Template (Optional)"}),e.jsxs("select",{value:S,onChange:a=>$(a.target.value),className:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",children:[e.jsx("option",{value:"",children:"Select a template..."}),y.map(a=>e.jsxs("option",{value:a.id,children:[a.channel_icon," ",a.name," - ",a.category]},a.id))]}),e.jsx(c,{message:d.template_id,className:"mt-2"})]}),n==="email"&&e.jsxs("div",{children:[e.jsx(i,{value:"Subject"}),e.jsx(w,{value:g.subject,onChange:a=>r("subject",a.target.value),className:"mt-1 block w-full",placeholder:"Enter email subject..."}),e.jsx(c,{message:d.subject,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(i,{value:"Message Content *"}),e.jsx("textarea",{value:g.content,onChange:a=>r("content",a.target.value),rows:6,className:"mt-1 block w-full border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm",placeholder:"Enter your message content..."}),e.jsx(c,{message:d.content,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx(i,{value:"Recipients *"}),e.jsxs("div",{className:"space-x-2",children:[e.jsxs("button",{type:"button",onClick:I,className:`px-3 py-1 text-sm rounded-md transition-colors ${m==="participants"?"bg-green-700 text-white ring-2 ring-green-300":"bg-green-600 hover:bg-green-700 text-white"}`,children:["ğŸ‘¥ All Participants",m==="participants"&&t.length>0&&e.jsxs("span",{className:"ml-2 text-xs bg-green-800 px-2 py-1 rounded-full",children:[t.length," selected"]})]}),e.jsxs("button",{type:"button",onClick:U,className:`px-3 py-1 text-sm rounded-md transition-colors ${m==="employees"?"bg-blue-700 text-white ring-2 ring-blue-300":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:["ğŸ‘¨â€ğŸ’¼ All Employees",m==="employees"&&t.length>0&&e.jsxs("span",{className:"ml-2 text-xs bg-blue-800 px-2 py-1 rounded-full",children:[t.length," selected"]})]}),e.jsx("button",{type:"button",onClick:L,className:"px-3 py-1 text-sm bg-indigo-600 hover:bg-indigo-700 text-white rounded-md",children:"â• Add Recipient"}),m&&e.jsx("button",{type:"button",onClick:()=>{l([]),h(""),r("recipients",[])},className:"px-3 py-1 text-sm bg-gray-600 hover:bg-gray-700 text-white rounded-md",children:"ğŸ—‘ï¸ Clear Selection"})]})]}),t.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"No recipients selected. Use the buttons above to add recipients."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:[m==="participants"?"ğŸ‘¥ Participants":"ğŸ‘¨â€ğŸ’¼ Employees"," Selected"]}),e.jsxs("span",{className:"text-blue-500 dark:text-blue-300 text-sm",children:["(",t.length," recipients)"]})]}),e.jsxs("span",{className:"text-blue-500 dark:text-blue-300 text-xs",children:["Channel: ",n.toUpperCase()]})]})}),e.jsx("div",{className:"space-y-3",children:t.map((a,s)=>e.jsxs("div",{className:"flex items-center space-x-3 p-3 border border-gray-300 dark:border-gray-600 rounded-lg",children:[e.jsxs("div",{className:"flex-1 grid grid-cols-2 gap-3",children:[e.jsx("input",{type:"text",value:a.name,onChange:o=>k(s,"name",o.target.value),placeholder:"Recipient name",className:"border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm"}),e.jsx("input",{type:"text",value:a.value,onChange:o=>k(s,"value",o.target.value),placeholder:n==="email"?"Email address":"Phone number",className:"border-gray-300 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 focus:border-indigo-500 dark:focus:border-indigo-600 focus:ring-indigo-500 dark:focus:ring-indigo-600 rounded-md shadow-sm"})]}),e.jsx("button",{type:"button",onClick:()=>H(s),className:"text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",children:"ğŸ—‘ï¸"})]},s))})]}),e.jsx(c,{message:d.recipients,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:"schedule_message",checked:p,onChange:a=>_(a.target.checked),className:"rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),e.jsx(i,{value:"Schedule for later"})]}),p&&e.jsxs("div",{className:"mt-3",children:[e.jsx(i,{value:"Send Date & Time"}),e.jsx(w,{type:"datetime-local",value:g.scheduled_at,onChange:a=>r("scheduled_at",a.target.value),className:"mt-1 block w-full",min:new Date(Date.now()+6e4).toISOString().slice(0,16)}),e.jsx(c,{message:d.scheduled_at,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx(N,{href:route("messages.index"),className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 text-sm font-medium rounded-lg transition-colors duration-200",children:"âŒ Cancel"}),e.jsx(W,{type:"submit",disabled:f||t.length===0,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700",children:f?"Sending...":p?"ğŸ“… Schedule Message":"ğŸ“¤ Send Message"})]})]})})})})})]})}export{ae as default};
