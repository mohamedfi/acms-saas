import{u as D,r as m,j as e,H as P}from"./app-BLl8wz7X.js";import{A as q}from"./AuthenticatedLayout-BBmj54qy.js";import"./ApplicationLogo-CLUV3Fv9.js";import"./transition-B5m-iN7L.js";function O({certificate:r,participants:c,courses:x,companies:u,backgroundImages:k,currentCourse:o,currentCompany:n}){const b=a=>{if(!a)return"";let d;if(typeof a=="string")d=new Date(a);else if(a instanceof Date)d=a;else return"";return isNaN(d.getTime())?"":d.toISOString().split("T")[0]},{data:i,setData:s,put:y,processing:h,errors:t}=D({course_id:(o==null?void 0:o.id)||"",participant_name:r.participant_name||"",participant_email:r.participant_email||"",company_id:(n==null?void 0:n.id)||"",completion_date:b(r.completion_date),issue_date:b(r.issue_date),description:r.description||"",background_image:null,selected_background_image:r.background_image||"",orientation:r.orientation||"landscape",status:r.status||"active",notes:r.notes||""}),[g,j]=m.useState(c.find(a=>a.full_name===r.participant_name)||null),[U,v]=m.useState(o||null),[$,N]=m.useState(n||null),[p,f]=m.useState(null),w=a=>{a.preventDefault(),y(route("certificates.update",r.id))},_=a=>{j(a),s("participant_name",a.full_name),s("participant_email",a.email),s("company_id",a.organization||"")},S=a=>{v(a),s("course_id",a.id)},C=a=>{N(a),s("company_id",a.id)},E=a=>{const d=a.target.files[0];if(d){s("background_image",d);const l=new FileReader;l.onload=I=>f(I.target.result),l.readAsDataURL(d)}};return e.jsxs(q,{header:e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"✏️ Edit Certificate"}),children:[e.jsx(P,{title:`Edit Certificate ${r.certificate_number}`}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-4xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:["✏️ Edit Certificate ",r.certificate_number]}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Update certificate information"})]}),e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select Participant"}),e.jsxs("select",{value:(g==null?void 0:g.id)||"",onChange:a=>{const d=c.find(l=>l.id==a.target.value);d&&_(d)},className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select a participant..."}),c.map(a=>e.jsxs("option",{value:a.id,children:[a.full_name," - ",a.email]},a.id))]}),t.participant_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.participant_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select Course *"}),e.jsxs("select",{value:i.course_id||"",onChange:a=>{const d=x.find(l=>l.id==a.target.value);d&&S(d)},className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0,children:[e.jsx("option",{value:"",children:"Select a course..."}),x.map(a=>e.jsxs("option",{value:a.id,children:[a.name," ",a.code&&`(${a.code})`]},a.id))]}),t.course_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.course_id})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Participant Name *"}),e.jsx("input",{type:"text",value:i.participant_name,onChange:a=>s("participant_name",a.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter participant name",required:!0}),t.participant_name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.participant_name})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Participant Email"}),e.jsx("input",{type:"email",value:i.participant_email,onChange:a=>s("participant_email",a.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter participant email"}),t.participant_email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.participant_email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Select Company"}),e.jsxs("select",{value:i.company_id||"",onChange:a=>{const d=u.find(l=>l.id==a.target.value);d&&C(d)},className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select a company..."}),u.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),t.company_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.company_id})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Completion Date *"}),e.jsx("input",{type:"date",value:i.completion_date,onChange:a=>s("completion_date",a.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0}),t.completion_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.completion_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Issue Date *"}),e.jsx("input",{type:"date",value:i.issue_date,onChange:a=>s("issue_date",a.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0}),t.issue_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.issue_date})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Certificate Orientation *"}),e.jsxs("select",{value:i.orientation,onChange:a=>s("orientation",a.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0,children:[e.jsx("option",{value:"landscape",children:"Landscape (Wide)"}),e.jsx("option",{value:"portrait",children:"Portrait (Tall)"})]}),t.orientation&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.orientation})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Status *"}),e.jsxs("select",{value:i.status,onChange:a=>s("status",a.target.value),className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",required:!0,children:[e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"revoked",children:"Revoked"}),e.jsx("option",{value:"expired",children:"Expired"})]}),t.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.status})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Background Image"}),r.background_image&&e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Current Background Image"}),e.jsx("div",{className:"relative w-full max-w-md",children:e.jsx("img",{src:r.background_image.startsWith("http")?r.background_image:`${window.location.origin}/storage/${r.background_image}`,alt:"Current Background",className:"w-full h-auto rounded-lg shadow-md border border-gray-200 dark:border-gray-600",onError:a=>{a.target.src=`${window.location.origin}/images/default-certificate-bg.jpg`}})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Upload New Background Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:E,className:"mt-1 block w-full text-sm text-gray-500 dark:text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100 dark:file:bg-gray-700 dark:file:text-gray-300"}),p&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:p,alt:"Preview",className:"h-32 w-auto rounded-lg border border-gray-300 dark:border-gray-600"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Or Select Existing Background Image"}),e.jsxs("select",{value:i.selected_background_image||"",onChange:a=>{s("selected_background_image",a.target.value),s("background_image",null),f(null)},className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",children:[e.jsx("option",{value:"",children:"Select existing background image..."}),k.map(a=>e.jsxs("option",{value:a.type==="uploaded"?`certificate-backgrounds/${a.filename}`:a.filename,children:[a.name," (",a.type,")"]},a.filename))]})]}),t.background_image&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.background_image})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Description"}),e.jsx("textarea",{value:i.description,onChange:a=>s("description",a.target.value),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter certificate description"}),t.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Notes"}),e.jsx("textarea",{value:i.notes,onChange:a=>s("notes",a.target.value),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Enter any additional notes"}),t.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.notes})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("a",{href:route("certificates.show",r.id),className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 cursor-pointer",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 border border-transparent rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed cursor-pointer",children:h?"Updating...":"Update Certificate"})]})]})]})})})})]})}export{O as default};
