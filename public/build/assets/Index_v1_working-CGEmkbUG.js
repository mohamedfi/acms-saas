import{r as d,j as e,H as f}from"./app-DPxrnJH9.js";import{A as N}from"./AuthenticatedLayout-dpSZcWTj.js";import"./ApplicationLogo-CRVY01fr.js";import"./transition-DYabZw25.js";function A({auth:p,course:r,attendanceSummary:b}){const[l,x]=d.useState(""),[c,i]=d.useState(""),[o,s]=d.useState(""),[m,g]=d.useState(!1),[n,y]=d.useState(b),h=async()=>{if(!l.trim()){s("Please enter a QR code");return}g(!0),s("");try{const a=await(await fetch("/attendance/scan-qr",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({qr_code:l,course_id:r.id,status:"present",method:"qr"})})).json();a.success?(i("success"),s(`✅ ${a.participant.name} - ${a.participant.status} at ${a.participant.time}`),x(""),await u()):(i("error"),s(`❌ ${a.message}`))}catch{i("error"),s("❌ Error scanning QR code. Please try again.")}finally{g(!1)}},u=async()=>{try{const t=await fetch(`/attendance/course/${r.id}`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(t.ok){const a=await t.json();a.attendanceSummary&&y(a.attendanceSummary)}}catch(t){console.error("Error refreshing attendance data:",t)}},j=t=>{switch(t){case"excellent":return"text-green-600 bg-green-100";case"good":return"text-blue-600 bg-blue-100";case"fair":return"text-yellow-600 bg-yellow-100";case"poor":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}};return e.jsxs(N,{user:p.user,children:[e.jsx(f,{title:`Attendance - ${r.course_name}`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg mb-6",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"📊 Attendance Management"}),e.jsxs("p",{className:"text-lg text-gray-600 dark:text-gray-400 mt-2",children:[r.course_name," -"," ",r.course_code]})]}),e.jsx("a",{href:`/archived-courses/${r.id}`,className:"inline-flex items-center px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white text-sm font-medium rounded-lg transition-colors duration-200",children:"← Back to Course"})]})})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg mb-6",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"📱 QR Code Scanner"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("input",{type:"text",value:l,onChange:t=>x(t.target.value),placeholder:"Enter QR code manually or scan",className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",onKeyPress:t=>t.key==="Enter"&&h()}),e.jsx("button",{onClick:h,disabled:m,className:"px-6 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors duration-200",children:m?"Scanning...":"Scan"})]}),o&&e.jsxs("div",{className:`mt-3 p-3 rounded-lg ${c==="success"?"bg-green-100 text-green-800":c==="error"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:[o,c==="success"&&e.jsx("div",{className:"mt-2 text-sm",children:"📊 Attendance data has been automatically updated below!"})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg mb-6",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4",children:"📊 Attendance Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg border border-blue-200 dark:border-blue-800",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:n.total_participants}),e.jsx("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Total Participants"})]}),e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:n.total_sessions}),e.jsx("div",{className:"text-sm text-green-600 dark:text-green-400",children:"Total Sessions"})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg border border-purple-200 dark:border-blue-800",children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600 dark:text-purple-400",children:[n.attendance_rate,"%"]}),e.jsx("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:"Overall Rate"})]}),e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-4 rounded-lg border border-orange-200 dark:border-orange-800",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600 dark:text-orange-400",children:r.participants?.length||0}),e.jsx("div",{className:"text-sm text-orange-600 dark:text-orange-400",children:"Enrolled"})]})]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-gray-100",children:"👥 Participant Attendance"}),e.jsx("button",{onClick:u,className:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors duration-200",children:"🔄 Refresh Data"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Participant"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"QR Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Present"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Absent"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Late"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Rate"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:n.participants?.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:t.name})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400 font-mono",children:t.qr_code})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-green-600 dark:text-green-400 font-medium",children:t.present_count})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-red-600 dark:text-red-400 font-medium",children:t.absent_count})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-yellow-600 dark:text-yellow-400 font-medium",children:t.late_count})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900 dark:text-gray-100 font-medium",children:[t.attendance_rate,"%"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${j(t.status)}`,children:t.status})})]},t.id))})]})})]})})]})})]})}export{A as default};
