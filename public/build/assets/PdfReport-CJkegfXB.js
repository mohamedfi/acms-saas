import{r as j,j as e,H as O,a as W,_ as I}from"./app-iMhGBJ6t.js";import{A as U}from"./AuthenticatedLayout-BJ22lr0f.js";import{C as d,a as x,b as u,c as g,B as M}from"./badge-Bea2zW0G.js";import{B as k}from"./button-a1xvKSFe.js";import"./ApplicationLogo-DW3cAdzV.js";import"./transition-BqJidYHT.js";function J({auth:F,bookings:C,stats:f,chartData:t,metadata:n}){var L,R,A,V;console.log("PdfReport props received:",{bookingsCount:(C==null?void 0:C.length)||0,stats:f,chartDataKeys:t?Object.keys(t):"No chartData",metadata:n}),t?(console.log("ChartData details:",{courseLabels:t.courseLabels,courseValues:t.courseValues,courseLabelsType:typeof t.courseLabels,courseValuesType:typeof t.courseValues,courseLabelsLength:(L=t.courseLabels)==null?void 0:L.length,courseValuesLength:(R=t.courseValues)==null?void 0:R.length,courseLabelsIsArray:Array.isArray(t.courseLabels),courseValuesIsArray:Array.isArray(t.courseValues)}),console.log("Full chartData object:",t),console.log("courseLabels content:",t.courseLabels),console.log("courseValues content:",t.courseValues),console.log("hallLabels content:",t.hallLabels),console.log("hallValues content:",t.hallValues),t.courseLabels&&t.courseLabels.length>0?(console.log("First course label:",t.courseLabels[0]),console.log("First course value:",t.courseValues[0])):console.log("courseLabels array is empty or undefined")):console.log("chartData is null or undefined");const r={courseChart:j.useRef(null),hallChart:j.useRef(null),monthlyChart:j.useRef(null),statusChart:j.useRef(null)};j.useEffect(()=>(typeof window<"u"&&(async()=>{try{console.log("Loading Chart.js...");const{default:a}=await I(async()=>{const{default:i}=await import("./auto-DO0dOiDN.js");return{default:i}},[]);window.Chart=a,console.log("Chart.js loaded successfully, initializing charts..."),setTimeout(()=>{B()},100)}catch(a){console.error("Failed to load Chart.js:",a)}})(),()=>{Object.values(r).forEach(a=>{a.current&&a.current.chart&&a.current.chart.destroy()})}),[t]);const z=()=>{Object.values(r).forEach(s=>{if(s.current&&s.current.chart){const a=s.current.chart,i=s.current,m=i.getContext("2d"),h=window.devicePixelRatio||1,p=i.getBoundingClientRect();i.width=p.width*h,i.height=p.height*h,m.scale(h,h),i.style.width=p.width+"px",i.style.height=p.height+"px",a.resize(),a.render()}})},B=()=>{try{if(console.log("Initializing charts with data:",t),!t||!t.courseLabels||!t.courseValues){console.warn("Chart data is incomplete, skipping chart initialization"),console.log("Chart data validation failed:",{hasChartData:!!t,hasCourseLabels:!!(t!=null&&t.courseLabels),hasCourseValues:!!(t!=null&&t.courseValues),chartDataKeys:t?Object.keys(t):"No chartData"});return}const s=[...t.courseLabels],a=[...t.courseValues],i=[...t.hallLabels],m=[...t.hallValues],h=[...t.monthlyLabels],p=[...t.monthlyValues],y=[...t.statusLabels],b=[...t.statusValues],N=[...t.trainerLabels],v=[...t.trainerValues];if(console.log("Cloned arrays for charts:",{courseLabels:s,courseValues:a,hallLabels:i,hallValues:m}),console.log("Starting chart creation..."),console.log("Course chart ref:",r.courseChart.current),console.log("Hall chart ref:",r.hallChart.current),console.log("Monthly chart ref:",r.monthlyChart.current),console.log("Status chart ref:",r.statusChart.current),Object.values(r).forEach(c=>{c.current&&c.current.chart&&c.current.chart.destroy()}),console.log("Creating course chart..."),r.courseChart.current&&s.length>0&&a.length>0){const c=new window.Chart(r.courseChart.current,{type:"doughnut",data:{labels:s,datasets:[{data:a,backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#84CC16","#F97316","#EC4899","#14B8A6"],borderWidth:2,borderColor:"#ffffff",hoverBorderWidth:3}]},options:{responsive:!0,maintainAspectRatio:!1,devicePixelRatio:2,onResize:(l,o)=>{l.canvas.style.width=o.width+"px",l.canvas.style.height=o.height+"px"},plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,font:{size:14,weight:"bold"}}},title:{display:!0,text:"Course Distribution",font:{size:18,weight:"bold"},color:"#374151"},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#ffffff",borderWidth:1}},animation:{duration:1e3,easing:"easeInOutQuart"}}});r.courseChart.current.chart=c,console.log("‚úÖ Course chart created successfully")}if(console.log("Creating hall chart..."),r.hallChart.current&&i.length>0&&m.length>0){const c=new window.Chart(r.hallChart.current,{type:"bar",data:{labels:i,datasets:[{label:"Bookings",data:m,backgroundColor:["#10B981","#3B82F6","#F59E0B","#EF4444","#8B5CF6","#06B6D4","#84CC16","#F97316"],borderColor:"#059669",borderWidth:2,borderRadius:4,borderSkipped:!1}]},options:{responsive:!0,maintainAspectRatio:!1,devicePixelRatio:2,onResize:(l,o)=>{l.canvas.style.width=o.width+"px",l.canvas.style.height=o.height+"px"},plugins:{legend:{display:!1},title:{display:!0,text:"Hall Utilization",font:{size:18,weight:"bold"},color:"#374151"},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#ffffff",borderWidth:1}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1,font:{size:12},color:"#6B7280"},grid:{color:"rgba(107, 114, 128, 0.2)"}},x:{ticks:{font:{size:12},color:"#6B7280"},grid:{display:!1}}},animation:{duration:1e3,easing:"easeOutQuart"}}});r.hallChart.current.chart=c,console.log("‚úÖ Hall chart created successfully")}if(console.log("Creating monthly chart..."),r.monthlyChart.current&&h.length>0&&p.length>0){const c=new window.Chart(r.monthlyChart.current,{type:"line",data:{labels:h,datasets:[{label:"Bookings",data:p,borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.15)",borderWidth:3,fill:!0,tension:.4,pointBackgroundColor:"#3B82F6",pointBorderColor:"#ffffff",pointBorderWidth:2,pointRadius:6,pointHoverRadius:8}]},options:{responsive:!0,maintainAspectRatio:!1,devicePixelRatio:2,onResize:(l,o)=>{l.canvas.style.width=o.width+"px",l.canvas.style.height=o.height+"px"},plugins:{legend:{display:!1},title:{display:!0,text:"Monthly Booking Trends",font:{size:18,weight:"bold"},color:"#374151"},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#ffffff",borderWidth:1,mode:"index",intersect:!1}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1,font:{size:12},color:"#6B7280"},grid:{color:"rgba(107, 114, 128, 0.2)"}},x:{ticks:{font:{size:12},color:"#6B7280"},grid:{color:"rgba(107, 114, 128, 0.1)"}}},interaction:{mode:"nearest",axis:"x",intersect:!1},animation:{duration:1e3,easing:"easeInOutQuart"}}});r.monthlyChart.current.chart=c,console.log("‚úÖ Monthly chart created successfully")}if(console.log("Creating status chart..."),r.statusChart.current&&y.length>0&&b.length>0){const c=new window.Chart(r.statusChart.current,{type:"pie",data:{labels:y.map(l=>l.charAt(0).toUpperCase()+l.slice(1).replace("_"," ")),datasets:[{data:b,backgroundColor:["#10B981","#F59E0B","#EF4444","#6B7280","#8B5CF6","#06B6D4","#84CC16","#F97316"],borderWidth:3,borderColor:"#ffffff",hoverBorderWidth:4}]},options:{responsive:!0,maintainAspectRatio:!1,devicePixelRatio:2,onResize:(l,o)=>{l.canvas.style.width=o.width+"px",l.canvas.style.height=o.height+"px"},plugins:{legend:{position:"bottom",labels:{padding:20,usePointStyle:!0,font:{size:14,weight:"bold"},color:"#374151"}},title:{display:!0,text:"Status Distribution",font:{size:18,weight:"bold"},color:"#374151"},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#ffffff",bodyColor:"#ffffff",borderColor:"#ffffff",borderWidth:1,callbacks:{label:function(l){const o=l.dataset.data.reduce((T,H)=>T+H,0),S=(l.parsed/o*100).toFixed(1);return`${l.label}: ${l.parsed} (${S}%)`}}}},animation:{duration:1e3,easing:"easeInOutQuart"}}});r.statusChart.current.chart=c,console.log("‚úÖ Status chart created successfully")}console.log("üéâ All charts initialized successfully!")}catch(s){console.error("Error initializing charts:",s),setTimeout(()=>{console.log("Retrying chart initialization...");try{B()}catch(a){console.error("Chart initialization retry failed:",a)}},500)}},w=s=>s?new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",_=s=>s?s.replace(":00",""):"N/A",P=s=>{switch(s){case"scheduled":return"bg-blue-100 text-blue-800";case"in_progress":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},E=()=>{window.print()};return e.jsxs(U,{user:F.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:"üìä Hall Bookings PDF Report"}),children:[e.jsx(O,{title:"Hall Bookings PDF Report"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[n&&e.jsx(d,{className:"mb-6 print:shadow-none",children:e.jsxs(x,{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Generated:"})," ",n.generated_at]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Total Records:"})," ",n.total_records]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Date Range:"})," ",(A=n.date_range)!=null&&A.earliest?w(n.date_range.earliest):"N/A"," ","-"," ",(V=n.date_range)!=null&&V.latest?w(n.date_range.latest):"N/A"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Courses:"})," ",Array.isArray(n.courses_filtered)?n.courses_filtered.join(", "):n.courses_filtered]})]}),n.error&&e.jsxs("div",{className:"mt-2 p-2 bg-red-100 text-red-800 rounded-md text-sm",children:["‚ö†Ô∏è ",n.error]})]})}),e.jsx("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg mb-8 print:mb-4",children:e.jsx("div",{className:"p-8 print:p-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-4 print:text-2xl",children:"üéì Training Hall Bookings Report"}),e.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-400 mb-6 print:text-base",children:"Comprehensive analysis of training hall utilization and course management"}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400 print:text-xs",children:["Generated on:"," ",new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8 print:grid-cols-5 print:gap-4",children:[e.jsxs(d,{className:"print:shadow-none",children:[e.jsx(u,{className:"pb-2 print:pb-1",children:e.jsx(g,{className:"text-sm font-medium text-gray-600 dark:text-gray-400 print:text-xs",children:"üìä Total Bookings"})}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white print:text-xl",children:f.total_bookings})})]}),e.jsxs(d,{className:"print:shadow-none",children:[e.jsx(u,{className:"pb-2 print:pb-1",children:e.jsx(g,{className:"text-sm font-medium text-gray-600 dark:text-gray-400 print:text-xs",children:"üìÖ Scheduled"})}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-blue-600 print:text-xl",children:f.scheduled_bookings})})]}),e.jsxs(d,{className:"print:shadow-none",children:[e.jsx(u,{className:"pb-2 print:pb-1",children:e.jsx(g,{className:"text-sm font-medium text-gray-600 dark:text-gray-400 print:text-xs",children:"‚è≥ In Progress"})}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-yellow-600 print:text-xl",children:f.in_progress_bookings})})]}),e.jsxs(d,{className:"print:shadow-none",children:[e.jsx(u,{className:"pb-2 print-1",children:e.jsx(g,{className:"text-sm font-medium text-gray-600 dark:text-gray-400 print:text-xs",children:"‚úÖ Completed"})}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600 print:text-xl",children:f.completed_bookings})})]}),e.jsxs(d,{className:"print:shadow-none",children:[e.jsx(u,{className:"pb-2 print:pb-1",children:e.jsx(g,{className:"text-sm font-medium text-gray-600 dark:text-gray-400 print:text-xs",children:"‚ùå Cancelled"})}),e.jsx(x,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600 print:text-xl",children:f.cancelled_bookings||0})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8 print:grid-cols-2 print:gap-6",children:[e.jsxs(d,{className:"print:shadow-none",children:[e.jsx(u,{children:e.jsx(g,{className:"text-lg font-semibold print:text-base",children:"üìö Course Distribution"})}),e.jsx(x,{children:e.jsx("div",{className:"h-64 print:h-48",children:e.jsx("canvas",{ref:r.courseChart,className:"w-full h-full"})})})]}),e.jsxs(d,{className:"print:shadow-none",children:[e.jsx(u,{children:e.jsx(g,{className:"text-lg font-semibold print:text-base",children:"üè¢ Hall Utilization"})}),e.jsx(x,{children:e.jsx("div",{className:"h-64 print:h-48",children:e.jsx("canvas",{ref:r.hallChart,className:"w-full h-full"})})})]}),e.jsxs(d,{className:"print:shadow-none",children:[e.jsx(u,{children:e.jsx(g,{className:"text-lg font-semibold print:text-base",children:"üìà Monthly Trends"})}),e.jsx(x,{children:e.jsx("div",{className:"h-64 print:h-48",children:e.jsx("canvas",{ref:r.monthlyChart,className:"w-full h-full"})})})]}),e.jsxs(d,{className:"print:shadow-none",children:[e.jsx(u,{children:e.jsx(g,{className:"text-lg font-semibold print:text-base",children:"üéØ Status Distribution"})}),e.jsx(x,{children:e.jsx("div",{className:"h-64 print:h-48",children:e.jsx("canvas",{ref:r.statusChart,className:"w-full h-full"})})})]})]}),e.jsxs(d,{className:"print:shadow-none",children:[e.jsx(u,{children:e.jsx(g,{className:"text-xl font-bold print:text-lg",children:"üìã Detailed Bookings"})}),e.jsx(x,{children:e.jsx("div",{className:"overflow-x-auto print:overflow-visible",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-800 print:bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider print:text-xs print:px-2 print:py-2",children:"Course"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider print:text-xs print:px-2 print:py-2",children:"Hall"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider print:text-xs print:px-2 print:py-2",children:"Trainer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider print:text-xs print:px-2 print:py-2",children:"Schedule"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider print:text-xs print:px-2 print:py-2",children:"Participants"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider print:text-xs print:px-2 print:py-2",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-gray-900 divide-y divide-gray-200 dark:divide-gray-700 print:bg-white",children:C.map((s,a)=>{var i,m,h,p,y,b,N,v;return e.jsxs("tr",{className:a%2===0?"bg-gray-50 dark:bg-gray-800 print:bg-gray-50":"bg-white dark:bg-gray-900 print:bg-white",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white print:text-xs print:px-2 print:py-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:((i=s.training_program)==null?void 0:i.name)||"N/A"}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-xs print:text-xs",children:((m=s.training_program)==null?void 0:m.code)||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white print:text-xs print:px-2 print:py-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:((h=s.training_hall)==null?void 0:h.name)||"N/A"}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-xs print:text-xs",children:((p=s.training_hall)==null?void 0:p.city)||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white print:text-xs print:px-2 print:py-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:((y=s.trainer)==null?void 0:y.full_name)||"N/A"}),e.jsx("div",{className:"text-gray-500 dark:text-gray-400 text-xs print:text-xs",children:((b=s.trainer)==null?void 0:b.position)||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white print:text-xs print:px-2 print:py-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[w(s.start_date)," ","-"," ",w(s.end_date)]}),e.jsxs("div",{className:"text-gray-500 dark:text-gray-400 text-xs print:text-xs",children:[_(s.start_time)," ","-"," ",_(s.end_time)]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white print:text-xs print:px-2 print:py-2",children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:[s.current_participants||0," ","/"," ",s.max_participants||0]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-1 print:h-1",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full print:h-1",style:{width:`${(s.current_participants||0)/(s.max_participants||1)*100}%`}})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap print:text-xs print:px-2 print:py-2",children:e.jsx(M,{className:`${P(s.status)} print:text-xs`,children:((N=s.status)==null?void 0:N.replace("_"," ").charAt(0).toUpperCase())+((v=s.status)==null?void 0:v.slice(1).replace("_"," "))||"Unknown"})})]},s.id)})})]})})})]}),e.jsxs("div",{className:"flex justify-center space-x-4 mt-8 print:hidden",children:[e.jsx(k,{onClick:z,className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 text-lg font-medium rounded-lg",children:"üéØ Optimize Charts for PDF"}),e.jsx(k,{onClick:E,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 text-lg font-medium rounded-lg",children:"üñ®Ô∏è Print/Export PDF"}),e.jsx(k,{onClick:()=>W.visit(route("hall-bookings.index")),className:"px-6 py-3 text-lg font-medium rounded-lg bg-gray-600 hover:bg-gray-700 text-white border-gray-600",children:"‚Üê Back to Bookings"})]}),e.jsxs("div",{className:"hidden print:block mt-8 text-center text-sm text-gray-600",children:[e.jsx("p",{children:"This report was generated from the PMEC Training Management System"}),e.jsx("p",{children:"For questions or support, please contact the system administrator"})]})]})})]})}export{J as default};
