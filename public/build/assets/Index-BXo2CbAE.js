import{r as a,u as A,j as e,H as F,L as m}from"./app-DPxrnJH9.js";import{A as Q}from"./AuthenticatedLayout-dpSZcWTj.js";import"./ApplicationLogo-CRVY01fr.js";import"./transition-DYabZw25.js";function H(){const[o,g]=a.useState([]),[k,u]=a.useState(!0),[R,$]=a.useState(null),[v,h]=a.useState(!1),[i,y]=a.useState(null),[d,p]=a.useState(""),[l,f]=a.useState(""),[n,j]=a.useState(""),[q,w]=a.useState([]),{delete:C}=A();a.useEffect(()=>{const t=window.location.origin;fetch(`${t}/api/participants`).then(s=>{if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return s.json()}).then(s=>{console.log("Debug - Participants data received:",s),g(s.data||[]),u(!1)}).catch(s=>{console.error("Error fetching participants:",s),u(!1)}),fetch(`${t}/api/courses`).then(s=>{if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return s.json()}).then(s=>{console.log("Debug - Courses data received:",s),w(s.data||[])}).catch(s=>{console.error("Error fetching courses:",s)})},[]);const _=t=>{confirm("Are you sure you want to delete this participant?")&&C(route("participants.destroy",t),{onSuccess:()=>{const s=window.location.origin;fetch(`${s}/api/participants`).then(r=>{if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return r.json()}).then(r=>{g(r.data||[])}).catch(r=>{console.error("Error refreshing participants:",r)})}})},E=t=>{y(t),h(!0)},b=()=>{h(!1),y(null)},c=()=>o.filter(t=>{const s=!d||t.nationality?.toLowerCase().includes(d.toLowerCase()),r=!n||t.organization?.toLowerCase().includes(n.toLowerCase());let x=!0;return l==="enrolled"?x=t.enrolled_courses_count>0:l==="not-enrolled"&&(x=t.enrolled_courses_count===0),s&&r&&x}),N=()=>{p(""),j(""),f("")},S=(t,s)=>{const r="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium";return s&&s.toLowerCase()==="egyptian"?`${r} bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200`:`${r} bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200`},P=(t,s)=>s&&s.toLowerCase()==="egyptian"?"Not Required":"Required",L=t=>t.split(" ").map(s=>s[0]).join("").toUpperCase().slice(0,2);return e.jsxs(Q,{header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800 dark:text-gray-200",children:"ðŸ‘¥ Participants Management"}),e.jsx(m,{href:route("participants.create"),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-md text-sm font-medium",children:"+ Add New Participant"})]}),children:[e.jsx(F,{title:"Participants"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-7xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg dark:bg-gray-800",children:e.jsx("div",{className:"p-6 text-gray-900 dark:text-gray-100",children:k?e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("span",{className:"ml-2",children:"Loading participants..."})]}):o.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"ðŸ‘¥"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-2",children:"No participants found"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Get started by adding your first participant."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-end",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"ðŸŒ Nationality"}),e.jsx("input",{type:"text",placeholder:"Filter by nationality...",value:d,onChange:t=>p(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:text-white dark:focus:ring-indigo-600 dark:focus:border-indigo-600"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"ðŸ¢ Organization/Country"}),e.jsx("input",{type:"text",placeholder:"Filter by organization or country...",value:n,onChange:t=>j(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:text-white dark:focus:ring-indigo-600 dark:focus:border-indigo-600"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"ðŸ“š Course Enrollment"}),e.jsxs("select",{value:l,onChange:t=>f(t.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 dark:bg-gray-600 dark:text-white dark:focus:ring-indigo-600 dark:focus:border-indigo-600",children:[e.jsx("option",{value:"",children:"All Participants"}),e.jsx("option",{value:"enrolled",children:"Enrolled in Courses"}),e.jsx("option",{value:"not-enrolled",children:"Not Enrolled"})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:N,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-md text-sm font-medium transition-colors",children:"ðŸ—‘ï¸ Clear"})})]}),(d||n||l)&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("span",{className:"font-medium",children:"Active Filters:"}),d&&e.jsxs("span",{className:"ml-2 px-2 py-1 bg-blue-100 dark:bg-blue-800 rounded text-xs",children:["Nationality:"," ",d]}),n&&e.jsxs("span",{className:"ml-2 px-2 py-1 bg-blue-100 dark:bg-blue-800 rounded text-xs",children:["Country:"," ",n]}),l&&e.jsxs("span",{className:"ml-2 px-2 py-1 bg-blue-100 dark:bg-blue-800 rounded text-xs",children:["Course:"," ",l==="enrolled"?"Enrolled":"Not Enrolled"]})]}),e.jsxs("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:["Showing"," ",c().length," ","of ",o.length," ","participants"]})]})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Nationality"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"ID/Passport"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Visa Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Courses"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"QR Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700",children:c().length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"px-6 py-8 text-center",children:e.jsxs("div",{className:"text-gray-500 dark:text-gray-400",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸ”"}),e.jsx("p",{className:"text-lg font-medium",children:"No participants match your filters"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search criteria or clear all filters"}),e.jsx("button",{onClick:N,className:"mt-3 px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md text-sm font-medium transition-colors",children:"Clear All Filters"})]})})}):c().map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 bg-indigo-600 rounded-full flex items-center justify-center overflow-hidden",children:t.thumbnail_url?e.jsx("img",{src:t.thumbnail_url,alt:t.full_name,className:"h-full w-full object-cover"}):e.jsx("span",{className:"text-white font-medium text-sm",children:L(t.full_name)})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:t.full_name}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["ID:"," ",t.id]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:t.email})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:t.phone||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:t.nationality||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:t.passport_no||"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:S(t.visa_status||"active",t.nationality),children:P(t.visa_status||"active",t.nationality)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:t.enrolled_courses_count||"0"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:t.qr_code?e.jsx("button",{onClick:()=>E(t),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300 font-medium",children:"ðŸ“± View QR"}):"N/A"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(m,{href:route("participants.show",t.id),className:"text-indigo-600 hover:text-indigo-900 dark:text-indigo-400 dark:hover:text-indigo-300",children:"View"}),e.jsx(m,{href:route("participants.edit",t.id),className:"text-gray-600 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-300",children:"Edit"}),e.jsx("button",{onClick:()=>_(t.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:"Delete"})]})})]},t.id))})]})})]})})})})}),v&&i&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["ðŸ“± QR Code - ",i.full_name]}),e.jsx("button",{onClick:b,className:"text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:e.jsx("img",{src:route("participants.qr-code",i.id),alt:`QR Code for ${i.full_name}`,className:"w-48 h-48 mx-auto border border-gray-300 dark:border-gray-600 rounded-lg"})}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"QR Code:"})," ",i.qr_code]}),e.jsx("p",{className:"mt-2",children:"Scan this QR code for attendance tracking and participant identification."})]}),e.jsxs("div",{className:"flex justify-center space-x-3",children:[e.jsx("button",{onClick:b,className:"px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-md text-sm font-medium transition-colors",children:"Close"}),e.jsx("button",{onClick:()=>{const t=document.createElement("a");t.href=route("participants.qr-code",i.id),t.download=`qr-code-${i.full_name}.svg`,t.click()},className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md text-sm font-medium transition-colors",children:"Download QR"})]})]})]})})]})}export{H as default};
